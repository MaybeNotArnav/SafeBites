<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>app.flow.graph</title>
    <meta name="generator" content="pydoctor 25.10.1"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
    
</head>

  <body>

    

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          SafeBites API <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="apidocs-help-button" title="Help" href="apidocs-help.html"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 10px;">
          <p>For more information on the search, visit the <a href="apidocs-help.html#rst-search">help page</a>.</p>
        </div>
      </div>

    </div>


  </div>
</nav>
    
    <div class="container-fluid">

      <!-- Side navigation -->
      <div class="sidebarcontainer" style="display: none;">
        
        <div class="sidebar"><nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Module</span>
        <code class="thisobject"><a href="app.flow.graph.html" class="internal-link" title="This module">graph</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#create_chat_graph" class="internal-link" title="app.flow.graph.create_chat_graph">create<wbr></wbr>_chat<wbr></wbr>_graph</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#generate_query_parts" class="internal-link" title="app.flow.graph.generate_query_parts">generate<wbr></wbr>_query<wbr></wbr>_parts</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#logger" class="internal-link" title="app.flow.graph.logger">logger</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Package</span>
        <code><a href="app.flow.html" class="internal-link" title="The parent of this module">flow</a></code> 
      </div>
      
      <div>
        

        <div class="childrenKindTitle">Modules</div>
        <ul>
    
    <li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="app.flow.graph.html" class="internal-link" title="app.flow.graph">graph</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="app.flow.state.html" class="internal-link" title="app.flow.state">state</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="app.flow.state_store.html" class="internal-link" title="app.flow.state_store">state<wbr></wbr>_store</a></code>
            </div>
        

    </li>
</ul> 

        
        

        
         

        
         

        
         

        
         
        
      </div>
  </div>

</nav>
        </div>
        <div id="collapse-sidebar">
          <a class="btn btn-link" onclick="toggleSideBarCollapse()" title="Toggle Sidebar Collapse">
          </a>
        </div> 
        <script src="sidebartoggle.js" type="text/javascript"></script>
       
      </div>

      <main class="">
        

        

        <div class="page-header">
          <h1 class="module"><code><code><a href="index.html" class="internal-link">app</a></code><wbr></wbr>.<code><a href="app.flow.html" class="internal-link" title="app.flow">flow</a></code><wbr></wbr>.<code><a href="app.flow.graph.html" class="internal-link" title="app.flow.graph">graph</a></code></code></h1>
          <div id="show-private">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          module documentation
        </div>

        <div class="extrasDocstring">
          
        </div>

        <div class="moduleDocstring">
          <div><p class="pre">Defines the conversational flow graph for the SafeBites chat assistant using LangGraph.

This module constructs a directed graph of nodes that represent each step
in processing a user's chat query. It integrates context resolution,
intent extraction, query part generation, data retrieval (menu and dish info),
and response synthesis into a cohesive pipeline.

Key Functions:
- generate_query_parts(state): Organizes extracted intents into structured query parts.
- create_chat_graph(): Builds and compiles the full LangGraph conversational flow.

The graph operates on ChatState objects, allowing stateful management of
user context, intents, queries, and responses throughout the conversation.</p></div>
        </div>

        <div id="split-tables">
          <table class="children sortable" id="id6">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#create_chat_graph" class="internal-link" title="app.flow.graph.create_chat_graph">create<wbr></wbr>_chat<wbr></wbr>_graph</a></code></td>
    <td>Construct and compile the LangGraph-based conversational flow for the chat system.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#generate_query_parts" class="internal-link" title="app.flow.graph.generate_query_parts">generate<wbr></wbr>_query<wbr></wbr>_parts</a></code></td>
    <td>Generate structured query parts from identified user intents.</td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#logger" class="internal-link" title="app.flow.graph.logger">logger</a></code></td>
    <td><span class="rst-undocumented">Undocumented</span></td>
  </tr>
</table>
          

            
        </div>

        <div id="child-list">
          <div class="basefunction">
  
  
  <a name="app.flow.graph.create_chat_graph">
    
  </a>
  <a name="create_chat_graph">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span>&#160;<span class="py-defname">create_chat_graph</span><span class="function-signature">():</span>
    
    <a class="headerLink" href="#create_chat_graph" title="app.flow.graph.create_chat_graph">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Construct and compile the LangGraph-based conversational flow for the chat system.

This function defines a directed graph of conversation processing nodes
that represent each stage of the dialogue handling pipeline — from
context resolution to final response synthesis.

The pipeline flow:
    1. **context_resolver** – Resolves conversation context and user state.
    2. **intent_classifier** – Extracts user intents from their input.
    3. **query_part_generator** – Organizes intents into structured queries.
    4. **menu_retriever** – Retrieves menu or restaurant data based on queries.
    5. **informative_retriever** – Fetches detailed dish information.
    6. **format_final_response** – Synthesizes a natural language response.

The graph uses `ChatState` to store and update intermediate information
throughout the conversation.

Returns:
    langgraph.graph.CompiledGraph: A compiled conversation graph that
    orchestrates all service nodes and their transitions.

Example:
    &gt;&gt;&gt; graph = create_chat_graph()
    &gt;&gt;&gt; response = graph.invoke(ChatState(user_message="Tell me about pizza"))
    &gt;&gt;&gt; print(response.output)
    "Pizza is a popular Italian dish available at..."</p></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="app.flow.graph.generate_query_parts">
    
  </a>
  <a name="generate_query_parts">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span>&#160;<span class="py-defname">generate_query_parts</span><span class="function-signature">(<span class="rst-sig-param">state</span>):</span>
    
    <a class="headerLink" href="#generate_query_parts" title="app.flow.graph.generate_query_parts">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Generate structured query parts from identified user intents.

This function processes the intents extracted from the user's input
and organizes them into categorized query parts (e.g., dish info,
restaurant menu). These query parts are later used by the retrieval
services to fetch the relevant data.

Args:
    state (ChatState): The current state of the chat, which includes
        user intents and contextual information.

Returns:
    ChatState: The updated state with `query_parts` populated, mapping
    intent types to their corresponding query strings.

Example:
    If the extracted intents are:
        [
            {"type": "menu", "query": "show me Italian restaurants"},
            {"type": "dish_info", "query": "what is pasta carbonara"}
        ]
    Then the resulting `query_parts` in state will be:
        {
            "menu": ["show me Italian restaurants"],
            "dish_info": ["what is pasta carbonara"]
        }</p></div>
  </div>
</div><div class="basevariable">
  
  
  <a name="app.flow.graph.logger">
    
  </a>
  <a name="logger">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">logger</span> =
    
    <a class="headerLink" href="#logger" title="app.flow.graph.logger">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>
        </div>
      
      </main>
    </div>

    <footer class="navbar navbar-default">

  
  <div class="container-fluid">
    <a href="index.html">API Documentation</a> for SafeBites API,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    25.10.1 at 2025-11-06 11:58:58.
  </div>

  <!-- Search related scripts needs to be loaded at the end of HTML 
    parsing not to introduce overhead and display HTML data asap -->
  <script src="ajax.js" type="text/javascript"></script>
  <script src="searchlib.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>